{
    "resource": "azurerm_firewall_policy_rule_collection_group",
    "rule_collection": [
        {
            "name": "example_group_name",
            "firewall_policy_id": "example_policy_id",
            "priority": 124,
            "network_rule_collection": [
                {
                    "name": "nesp-np-globalrules-nco",
                    "priority": 100,
                    "action": "Allow",
                    "rules": [
                        {
                            "name": "nesp-np-22-Internaltolz-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ports": [
                                "22"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-22-lztointernal-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ports": [
                                "22"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-3389-Internaltolz-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ports": [
                                "3389"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-3389-lztointernal-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ports": [
                                "3389"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-53-allowdns-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ports": [
                                "53"
                            ],
                            "protocols": [
                                "TCP",
                                "UDP"
                            ]
                        },
                        {
                            "name": "nesp-np-443-internalapplication-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_ports": [
                                "443"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-636-onpremtolz-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_Nespresso_Onprem"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ports": [
                                "636"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-636-lztoonprem-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_Nespresso_Onprem"
                            ],
                            "destination_ports": [
                                "636"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-25-onpremtolz-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_Nespresso_Onprem"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ports": [
                                "25"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-25-lztoonprem-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_usea_np_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_pr_Azure_Network",
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_asse_np_Azure_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_Nespresso_Onprem"
                            ],
                            "destination_ports": [
                                "25"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-5000-lztoeda-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_euwe_np_Azure_Network"
                            ],
                            "destination_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_np_eda"
                            ],
                            "destination_ports": [
                                "5000-5010"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        }
                    ]
                },
                {
                    "name": "nesp-np-mdmsemarchy-nco",
                    "priority": 101,
                    "action": "Allow",
                    "rules": [
                        {
                            "name": "nesp-np-sqlServer-nrl",
                            "source_addresses": [
                                "10.118.21.32/27"
                            ],
                            "destination_addresses": [
                                "10.118.21.64/27"
                            ],
                            "destination_ports": [
                                "1433"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-valconSQL-nrl",
                            "source_addresses": [
                                "10.235.222.25",
                                "10.235.222.28",
                                "10.235.222.22",
                                "10.235.222.23",
                                "10.235.222.24",
                                "10.235.222.149",
                                "10.235.222.150"
                            ],
                            "destination_addresses": [
                                "10.118.21.64/27"
                            ],
                            "destination_ports": [
                                "1433"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-semarchyValconVDI-nrl",
                            "source_addresses": [
                                "10.235.222.25",
                                "10.235.222.28",
                                "10.235.222.22",
                                "10.235.222.23",
                                "10.235.222.24",
                                "10.235.222.149",
                                "10.235.222.150"
                            ],
                            "destination_addresses": [
                                "10.118.21.32/27"
                            ],
                            "destination_ports": [
                                "8088"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-semarchyInternal-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_addresses": [
                                "10.118.21.32/27"
                            ],
                            "destination_ports": [
                                "8088"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-semarchySMTP-nrl",
                            "source_addresses": [
                                "10.118.21.32/27"
                            ],
                            "destination_addresses": [
                                "10.56.34.150"
                            ],
                            "destination_ports": [
                                "587",
                                "25"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-nespressoNexus-nrl",
                            "source_addresses": [
                                "10.118.21.32/27"
                            ],
                            "destination_addresses": [
                                "10.56.14.45"
                            ],
                            "destination_ports": [
                                "80"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-sandbox-backend-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_addresses": [
                                "10.118.16.32/28"
                            ],
                            "destination_ports": [
                                "22"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        }
                    ]
                },
                {
                    "name": "nesp-np-testdatamanagement-nco",
                    "priority": 102,
                    "action": "Allow",
                    "rules": [
                        {
                            "name": "nesp-np-tdmIcariaHttp-nrl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_All_Internal_Network"
                            ],
                            "destination_addresses": [
                                "10.118.5.36"
                            ],
                            "destination_ports": [
                                "8080",
                                "8000",
                                "8443"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        },
                        {
                            "name": "nesp-np-nespressoDB-nrl",
                            "source_addresses": [
                                "10.118.5.36"
                            ],
                            "destination_addresses": [
                                "10.136.11.0/25",
                                "10.136.12.0/25"
                            ],
                            "destination_ports": [
                                "1522"
                            ],
                            "protocols": [
                                "TCP"
                            ]
                        }
                    ]
                }
            ],
            "application_rule_collection": [
                {
                    "name": "nesp-np-tap-aco",
                    "priority": 103,
                    "action": "Allow",
                    "rules": [
                        {
                            "name": "nesp-np-80-vpn-global-protect-arl",
                            "source_ip_groups": [
                                "/subscriptions/052085ce-1c15-489c-9a9f-9fc29729dfd2/resourceGroups/nesp-pr-hub.ip-group-rgp/providers/Microsoft.Network/ipGroups/nesp_ipg_glbl_global_protect_vpn"
                            ],
                            "destination_fqdn": [
                                "10.118.10.78"
                            ],
                            "protocols": [
                                {
                                    "type": "Http",
                                    "port": 80
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}